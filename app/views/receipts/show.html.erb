<% if current_user.role == 3 %>
	<% student_name = User.find_by(id: Receipt.find_by(id: @receipt.user_id)) %>
  	<%= link_to 'Back to ' + student_name.first_name + '\'s Clients', my_receipts_path(@receipt.user_id)  %>
<br /><br />
<% end %>

  <%= render :partial => 'show_client_info', :locals => { :client => @client }%>
  
<div id="edit_client">
  <%= link_to 'Edit this client!', edit_client_path(@client.id, page: request.url) unless @receipt.user_id != @receipt.ticket.user_id%>
</div>

<div>
<% if Receipt.is_released(@receipt) == false %>
<div class="form_background">
<%= form_tag(actions_path, id: "new_action") do %>


  <div id="FirstContact" class = "action" <%= 'class = hidden' unless (@receipt.made_contact == false)%>>
	 
	<p class="alert alert-info">My Sales Progress</p>

  	 <%= check_box_tag(:contact) %>
  	 <%= label_tag(:contact, 'I contacted my client!')%>
  </div>
  <div id="timepicker" class="hidden">
	<%= label_tag(:user_action_time, 'Time Accomplished', class: 'required') %>
<%= text_field_tag(:user_action_time, '', :placeholder => 'YYYY/MM/DD 00:00 AM/PM',  :class=>'form-control') %>
  </div>
        <div id = "firstCheck" <%= 'class = hidden' unless (@receipt.made_contact == true) && @receipt.made_presentation == (false) %>>
      
		  <div  class = "action">
		   <%= check_box_tag(:presentation) %>
          <%= label_tag(:presentation, 'I made a presentation!') %>  
	  </div> 
        </div>

        <div id = "checkers2" <%= 'class = hidden' unless (@receipt.made_presentation == true) && (@receipt.made_sale == false) %>>
         
        <div class = "action">
			 <%= check_box_tag(:sale) %>
          <%= label_tag('sale', 'I made a sale!') %>
        </div>
        </div>

        <div id = "saleMade" class="hidden">
                   
         
			  <%= label_tag('price', 'Sale Amount', class: 'required', id: 'price_label') %>  
                <%= text_field_tag(:price, '', :placeholder => 'Examples: 50 or 75', :class=>'form-control') %>  <br />               
             

          <%= label_tag('page', 'Page Size', class: 'required', id: 'page_size') %>
          <%= select_tag(:page, options_for_select([["Whole page", 1], ["1/2 page", 0.5], ["1/4 page", 0.25], ["1/8 page", 0.125], ["Other", :id=> 'o']]))%>
          <%= text_field_tag(:otherSize, '', :placeholder => '(1/5, 1/3, etc.) ', :class => "hidden")%><br />
          <%= label_tag('payment_type', 'Payment Type', id:'payment') %>
          <%= select_tag('payment_type', options_for_select(%w(Cash Credit Invoice Check Dept. Trans.)))%>
        </div>
    <br />
    
    
    
    <div id="comment">
      <%= label_tag('comments', 'Comment') %>
      <%= text_area_tag :comment, @comment, :class => 'form-control', :id => 'comment_box'%>
    </div>
    

    <%= hidden_field_tag 'receipt_id', @receipt.id %>
    <div id="submit">
      <%= submit_tag('Save Progress', class: 'btn btn-primary btn-lg')%>
    </div>
    
</div>
    <% end %>
    <% if @receipt.made_sale %>
	 <div class = "panel panel-primary">
	   <div class = "panel-heading">
	     <h3>&nbsp;Completed Sale Details</h3><br>
	   </div>
	 <div class = "panel-body">
     <p class="sale_information">
        <strong>Sale Amount:&nbsp;$ <%=@receipt.sale_value %></strong>
        <strong>Page Size:&nbsp; <%=@receipt.page_size %></strong>
        <strong>Payment Type:&nbsp; <%=@receipt.payment_type %></strong>
    </p>
</div>
</div>
<% end %>
<% else %>
<p>Since you released this client, you no longer can update it.</p>
<% end %>
</div>

<div id = "show_action_table">
  <%= render :partial => 'action_table', :locals => { :receipt => @receipt }%>
</div>
  <br><br/>
<% if current_user.role != 3 %>
  <%= link_to 'Back to My Clients', my_receipts_path(@receipt.user_id) %>
<% end %>

